var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function r(e,...n){if(null==e)return t;const s=e.subscribe(...n);return s.unsubscribe?()=>s.unsubscribe():s}function c(t,e,n){t.$$.on_destroy.push(r(e,n))}function l(t,e,n,s){return t[1]&&s?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](s(e))):n.ctx}function u(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function d(t){t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function f(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function g(t){return document.createTextNode(t)}function $(){return g(" ")}function m(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function v(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function x(t,e){e=""+e,t.data!==e&&(t.data=e)}function b(t,e,n){t.classList[n?"add":"remove"](e)}let k;function y(t){k=t}function w(){if(!k)throw new Error("Function called outside component initialization");return k}function I(t){w().$$.on_mount.push(t)}const S=[],_=[],N=[],T=[],E=Promise.resolve();let D=!1;function X(t){N.push(t)}function Y(t){T.push(t)}const C=new Set;function M(){do{for(;S.length;){const t=S.shift();y(t),z(t.$$)}for(;_.length;)_.pop()();for(let t=0;t<N.length;t+=1){const e=N[t];C.has(e)||(C.add(e),e())}N.length=0}while(S.length);for(;T.length;)T.pop()();D=!1,C.clear()}function z(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(X)}}const B=new Set;let O;function A(){O={r:0,c:[],p:O}}function j(){O.r||s(O.c),O=O.p}function F(t,e){t&&t.i&&(B.delete(t),t.i(e))}function L(t,e,n,s){if(t&&t.o){if(B.has(t))return;B.add(t),O.c.push(()=>{B.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}}function R(t,e){L(t,1,1,()=>{e.delete(t.key)})}function G(t,e,n){const s=t.$$.props[e];void 0!==s&&(t.$$.bound[s]=n,n(t.$$.ctx[s]))}function P(t){t&&t.c()}function U(t,n,i){const{fragment:r,on_mount:c,on_destroy:l,after_update:u}=t.$$;r&&r.m(n,i),X(()=>{const n=c.map(e).filter(o);l?l.push(...n):s(n),t.$$.on_mount=[]}),u.forEach(X)}function q(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function H(t,e){-1===t.$$.dirty[0]&&(S.push(t),D||(D=!0,E.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function J(e,o,i,r,c,l,u=[-1]){const a=k;y(e);const d=o.props||{},h=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:n(),dirty:u};let p=!1;h.ctx=i?i(e,d,(t,n,...s)=>{const o=s.length?s[0]:n;return h.ctx&&c(h.ctx[t],h.ctx[t]=o)&&(h.bound[t]&&h.bound[t](o),p&&H(e,t)),n}):[],h.update(),p=!0,s(h.before_update),h.fragment=!!r&&r(h.ctx),o.target&&(o.hydrate?h.fragment&&h.fragment.l(function(t){return Array.from(t.childNodes)}(o.target)):h.fragment&&h.fragment.c(),o.intro&&F(e.$$.fragment),U(e,o.target,o.anchor),M()),y(a)}class K{$destroy(){q(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}class Q{constructor(){this.events={}}unsubscribe(t){delete this.events[t]}subscribe(t,e){if(!(e instanceof Function))throw new Error(`'${t}' callback is not a functions`);this.events[t]=e}dispatch(t,...e){this.events[t]instanceof Function&&this.events[t](...e)}forward(t,...e){for(const n of e)this.subscribe(n,(...e)=>{t.dispatch(n,...e)})}}const V=[];function W(e,n=t){let s;const o=[];function r(t){if(i(e,t)&&(e=t,s)){const t=!V.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),V.push(n,e)}if(t){for(let t=0;t<V.length;t+=2)V[t][0](V[t+1]);V.length=0}}}return{set:r,update:function(t){r(t(e))},subscribe:function(i,c=t){const l=[i,c];return o.push(l),1===o.length&&(s=n(r)||t),i(e),()=>{const t=o.indexOf(l);-1!==t&&o.splice(t,1),0===o.length&&(s(),s=null)}}}}class Z{constructor(t,e){this._x=t||0,this._y=e||0,this.reactiveX=W(0),this.reactiveY=W(0),this.reactiveX.subscribe(t=>this._x=t),this.reactiveY.subscribe(t=>this._y=t)}get x(){return this._x}get y(){return this._y}set x(t){this.reactiveX.set(t)}set y(t){this.reactiveY.set(t)}}class tt extends Q{constructor(t){super(),this.position=new Z,this.initialX=0,this.initialY=0,this.dragging=!1,this.absolute=t||!1}dragStart(t){t.preventDefault(),"touchstart"===t.type?(this.initialX=t.touches[0].clientX-this.position.x,this.initialY=t.touches[0].clientY-this.position.y):(this.initialX=t.clientX-this.position.x,this.initialY=t.clientY-this.position.y),this.subscribe("move",t=>this.drag(t)),this.subscribe("stop",t=>this.dragEnd(t)),this.dragging=!0}dragEnd(){this.initialX=this.x,this.initialY=this.y,this.dragging=!1,this.unsubscribe("move"),this.unsubscribe("stop"),this.dispatch("dragEnd")}drag(t){if(!this.dragging)return;let e,n;t.preventDefault(),"touchmove"===t.type?(e=t.touches[0].clientX,n=t.touches[0].clientY):(e=t.clientX,n=t.clientY),this.absolute?(this.position.x=e,this.position.y=n):(this.position.x=e-this.initialX,this.position.y=n-this.initialY)}}function et(e){let n,o,i,r,c,l,h,g,$;return{c(){n=p("div"),o=f("svg"),i=f("filter"),r=f("feGaussianBlur"),c=f("g"),l=f("path"),h=f("g"),g=f("path"),v(r,"stdDeviation","5"),v(r,"in","SourceGraphic"),v(i,"id","highlight"),v(i,"filterUnits","userSpaceOnUse"),v(l,"class","curve-selector svelte-15c3i01"),v(l,"d",e[2]),v(g,"class","curve svelte-15c3i01"),v(g,"d",e[2]),v(o,"class","svelte-15c3i01"),v(n,"class","node-relation svelte-15c3i01")},m(t,s){a(t,n,s),u(n,o),u(o,i),u(i,r),u(o,c),u(c,l),u(o,h),u(h,g),$=[m(l,"touchstart",e[9]),m(l,"mousedown",e[10])]},p(t,[e]){4&e&&v(l,"d",t[2]),4&e&&v(g,"d",t[2])},i:t,o:t,d(t){t&&d(n),s($)}}}class nt extends tt{constructor(t,e,n){super(!0),this.index=e,this.sourceNodeIndex=t.sourceNodeIndex,this.sourceSocketIndex=t.sourceSocketIndex,this.targetNodeIndex=t.targetNodeIndex,this.targetSocketIndex=t.targetSocketIndex,this.sourceSocket=n.nodes[t.sourceNodeIndex].outputs[t.sourceSocketIndex],this.targetSocket=n.nodes[t.targetNodeIndex].inputs[t.targetSocketIndex],this.curve=W()}update(t,e){let n=this.targetSocket.x,s=this.targetSocket.y,o=this.sourceSocket.x,i=this.sourceSocket.y;if(this.dragging&&(n=t,s=e),!(n&&s&&o&&i&&this.curvature))return;let r=n-(n-o)/2,c=o+(n-o)/2;r=Math.max(r,o+this.curvature),c=Math.min(r,n-this.curvature);let l=i,u=s;this.curve.set(`M${o},${i} C${r}, ${l} ${c},${u} ${n},${s}`)}}function st(e,n,s){let o,i,l,u=t,a=()=>(u(),u=r(d,t=>s(2,l=t)),d);e.$$.on_destroy.push(()=>u());let d,{relation:h}=n,{curvature:p=100}=n;function f(t,e){h.update(t,e),a(s(1,d=h.curve))}h.curvature=p,a();let g=h.position.reactiveX;c(e,g,t=>s(6,o=t));let $=h.position.reactiveY;c(e,$,t=>s(7,i=t)),h.subscribe("dragEnd",()=>f());return e.$set=t=>{"relation"in t&&s(0,h=t.relation),"curvature"in t&&s(5,p=t.curvature)},e.$$.update=()=>{192&e.$$.dirty&&f(o,i)},[h,d,l,g,$,p,o,i,f,t=>h.dragStart(t),t=>h.dragStart(t)]}class ot extends K{constructor(t){super(),J(this,t,st,et,i,{relation:0,curvature:5})}}function it(e){let n,s;return{c(){n=p("button"),v(n,"class","svelte-19aedad")},m(t,o){a(t,n,o),e[1](n),s=m(n,"mousedown",e[2])},p:t,i:t,o:t,d(t){t&&d(n),e[1](null),s()}}}class rt extends Q{constructor(t,e,n,s){super(),this.label=t,this.index=e,this.nodeIndex=n,this.type=s}update(){if(!this.element)return;let t=this.element.getBoundingClientRect();this.x=t.left+t.width/2,this.y=t.top+t.height/2}}function ct(t,e,n){let{socket:s}=e;return t.$set=t=>{"socket"in t&&n(0,s=t.socket)},[s,function(t){_[t?"unshift":"push"](()=>{s.element=t,n(0,s)})},t=>s.dispatch("socketDown",t,s)]}class lt extends K{constructor(t){super(),J(this,t,ct,it,i,{socket:0})}}function ut(t){let e,n,o;const i=t[6].default,r=function(t,e,n,s){if(t){const o=l(t,e,n,s);return t[0](o)}}(i,t,t[5],null);return{c(){e=p("div"),r&&r.c(),v(e,"class","selectable svelte-oot6ue"),b(e,"selected",t[2]),b(e,"absolute",t[1])},m(s,i){a(s,e,i),r&&r.m(e,null),t[7](e),n=!0,o=[m(e,"mouseenter",t[8]),m(e,"mouseleave",t[9])]},p(t,[n]){r&&r.p&&32&n&&r.p(l(i,t,t[5],null),function(t,e,n,s){if(t[2]&&s){const o=t[2](s(n));if("object"==typeof e.dirty){const t=[],n=Math.max(e.dirty.length,o.length);for(let s=0;s<n;s+=1)t[s]=e.dirty[s]|o[s];return t}return e.dirty|o}return e.dirty}(i,t[5],n,null)),4&n&&b(e,"selected",t[2]),2&n&&b(e,"absolute",t[1])},i(t){n||(F(r,t),n=!0)},o(t){L(r,t),n=!1},d(n){n&&d(e),r&&r.d(n),t[7](null),s(o)}}}function at(t,e,n){let{events:s}=e,{absolute:o=!1}=e,{container:i=null}=e,r=!1,c=!1;var l;I(()=>s.subscribe("click",()=>{n(2,r=!!c)})),l=()=>s.unsubscribe("click"),w().$$.on_destroy.push(l);let{$$slots:u={},$$scope:a}=e;return t.$set=t=>{"events"in t&&n(4,s=t.events),"absolute"in t&&n(1,o=t.absolute),"container"in t&&n(0,i=t.container),"$$scope"in t&&n(5,a=t.$$scope)},[i,o,r,c,s,a,u,function(t){_[t?"unshift":"push"](()=>{n(0,i=t)})},t=>n(3,c=!0),t=>n(3,c=!1)]}class dt extends K{constructor(t){super(),J(this,t,at,ut,i,{events:4,absolute:1,container:0})}}function ht(t,e,n){const s=t.slice();return s[12]=e[n].label,s[14]=n,s}function pt(t,e,n){const s=t.slice();return s[12]=e[n].label,s[14]=n,s}function ft(t){let e,n,s,o,i,r=t[0].inputs,c=[];for(let e=0;e<r.length;e+=1)c[e]=gt(pt(t,r,e));const l=t=>L(c[t],1,1,()=>{c[t]=null});return{c(){e=p("div"),n=p("label"),n.textContent="Inputs",s=$(),o=p("ul");for(let t=0;t<c.length;t+=1)c[t].c();v(n,"class","svelte-6k18oc"),v(o,"class","sockets svelte-6k18oc"),v(e,"class","inputs svelte-6k18oc")},m(t,r){a(t,e,r),u(e,n),u(e,s),u(e,o);for(let t=0;t<c.length;t+=1)c[t].m(o,null);i=!0},p(t,e){if(1&e){let n;for(r=t[0].inputs,n=0;n<r.length;n+=1){const s=pt(t,r,n);c[n]?(c[n].p(s,e),F(c[n],1)):(c[n]=gt(s),c[n].c(),F(c[n],1),c[n].m(o,null))}for(A(),n=r.length;n<c.length;n+=1)l(n);j()}},i(t){if(!i){for(let t=0;t<r.length;t+=1)F(c[t]);i=!0}},o(t){c=c.filter(Boolean);for(let t=0;t<c.length;t+=1)L(c[t]);i=!1},d(t){t&&d(e),h(c,t)}}}function gt(t){let e,n,s,o,i,r,c,l=t[12]+"";function h(e){t[8].call(null,e,t[14])}let f={};void 0!==t[0].inputs[t[14]]&&(f.socket=t[0].inputs[t[14]]);const m=new lt({props:f});return _.push(()=>G(m,"socket",h)),{c(){e=p("li"),P(m.$$.fragment),s=$(),o=p("span"),i=g(l),r=$(),v(o,"class","svelte-6k18oc"),v(e,"class","svelte-6k18oc")},m(t,n){a(t,e,n),U(m,e,null),u(e,s),u(e,o),u(o,i),u(e,r),c=!0},p(e,s){t=e;const o={};!n&&1&s&&(n=!0,o.socket=t[0].inputs[t[14]],Y(()=>n=!1)),m.$set(o),(!c||1&s)&&l!==(l=t[12]+"")&&x(i,l)},i(t){c||(F(m.$$.fragment,t),c=!0)},o(t){L(m.$$.fragment,t),c=!1},d(t){t&&d(e),q(m)}}}function $t(t){let e,n,s,o,i,r=t[0].outputs,c=[];for(let e=0;e<r.length;e+=1)c[e]=mt(ht(t,r,e));const l=t=>L(c[t],1,1,()=>{c[t]=null});return{c(){e=p("div"),n=p("label"),n.textContent="Outputs",s=$(),o=p("ul");for(let t=0;t<c.length;t+=1)c[t].c();v(n,"class","svelte-6k18oc"),v(o,"class","sockets svelte-6k18oc"),v(e,"class","outputs svelte-6k18oc")},m(t,r){a(t,e,r),u(e,n),u(e,s),u(e,o);for(let t=0;t<c.length;t+=1)c[t].m(o,null);i=!0},p(t,e){if(1&e){let n;for(r=t[0].outputs,n=0;n<r.length;n+=1){const s=ht(t,r,n);c[n]?(c[n].p(s,e),F(c[n],1)):(c[n]=mt(s),c[n].c(),F(c[n],1),c[n].m(o,null))}for(A(),n=r.length;n<c.length;n+=1)l(n);j()}},i(t){if(!i){for(let t=0;t<r.length;t+=1)F(c[t]);i=!0}},o(t){c=c.filter(Boolean);for(let t=0;t<c.length;t+=1)L(c[t]);i=!1},d(t){t&&d(e),h(c,t)}}}function mt(t){let e,n,s,o,i,r,c,l=t[12]+"";function h(e){t[9].call(null,e,t[14])}let f={};void 0!==t[0].outputs[t[14]]&&(f.socket=t[0].outputs[t[14]]);const m=new lt({props:f});return _.push(()=>G(m,"socket",h)),{c(){e=p("li"),n=p("span"),s=g(l),o=$(),P(m.$$.fragment),r=$(),v(n,"class","svelte-6k18oc"),v(e,"class","svelte-6k18oc")},m(t,i){a(t,e,i),u(e,n),u(n,s),u(e,o),U(m,e,null),u(e,r),c=!0},p(e,n){t=e,(!c||1&n)&&l!==(l=t[12]+"")&&x(s,l);const o={};!i&&1&n&&(i=!0,o.socket=t[0].outputs[t[14]],Y(()=>i=!1)),m.$set(o)},i(t){c||(F(m.$$.fragment,t),c=!0)},o(t){L(m.$$.fragment,t),c=!1},d(t){t&&d(e),q(m)}}}function vt(t){let e,n,o,i,r,c,l,h,f,b=t[0].name+"",k=t[0].inputs.length>0&&ft(t),y=t[0].outputs.length>0&&$t(t);return{c(){e=p("div"),n=p("div"),o=p("label"),i=g(b),r=$(),c=p("div"),k&&k.c(),l=$(),y&&y.c(),v(o,"class","title svelte-6k18oc"),v(n,"class","selector svelte-6k18oc"),v(c,"class","node-content svelte-6k18oc"),v(e,"class","node svelte-6k18oc")},m(s,d){a(s,e,d),u(e,n),u(n,o),u(o,i),u(e,r),u(e,c),k&&k.m(c,null),u(c,l),y&&y.m(c,null),h=!0,f=[m(n,"touchstart",t[6]),m(n,"mousedown",t[7])]},p(t,e){(!h||1&e)&&b!==(b=t[0].name+"")&&x(i,b),t[0].inputs.length>0?k?(k.p(t,e),F(k,1)):(k=ft(t),k.c(),F(k,1),k.m(c,l)):k&&(A(),L(k,1,1,()=>{k=null}),j()),t[0].outputs.length>0?y?(y.p(t,e),F(y,1)):(y=$t(t),y.c(),F(y,1),y.m(c,null)):y&&(A(),L(y,1,1,()=>{y=null}),j())},i(t){h||(F(k),F(y),h=!0)},o(t){L(k),L(y),h=!1},d(t){t&&d(e),k&&k.d(),y&&y.d(),s(f)}}}function xt(t){let e,n,s;function o(e){t[10].call(null,e)}function i(e){t[11].call(null,e)}let r={absolute:!0,$$slots:{default:[vt]},$$scope:{ctx:t}};void 0!==t[0]&&(r.events=t[0]),void 0!==t[1]&&(r.container=t[1]);const c=new dt({props:r});return _.push(()=>G(c,"events",o)),_.push(()=>G(c,"container",i)),{c(){P(c.$$.fragment)},m(t,e){U(c,t,e),s=!0},p(t,[s]){const o={};65537&s&&(o.$$scope={dirty:s,ctx:t}),!e&&1&s&&(e=!0,o.events=t[0],Y(()=>e=!1)),!n&&2&s&&(n=!0,o.container=t[1],Y(()=>n=!1)),c.$set(o)},i(t){s||(F(c.$$.fragment,t),s=!0)},o(t){L(c.$$.fragment,t),s=!1},d(t){q(c,t)}}}class bt extends tt{constructor(t,e){super(),this.name=t.name,this.index=e,this.inputs=t.inputs.map((t,n)=>new rt(t.label,n,e,"input")),this.outputs=t.outputs.map((t,n)=>new rt(t.label,n,e,"output"))}update(){this.inputs.forEach(t=>t.update()),this.outputs.forEach(t=>t.update())}}function kt(t,e,n){let s,o,i,{node:r}=e,l=r.position.reactiveX;c(t,l,t=>n(4,s=t));let u=r.position.reactiveY;c(t,u,t=>n(5,o=t)),r.inputs.forEach(t=>t.forward(r,"socketDown")),r.outputs.forEach(t=>t.forward(r,"socketDown"));return t.$set=t=>{"node"in t&&n(0,r=t.node)},t.$$.update=()=>{51&t.$$.dirty&&i&&(n(1,i.style.transform="translate3d("+s+"px, "+o+"px, 0)",i),r.update())},[r,i,l,u,s,o,t=>r.dragStart(t),t=>r.dragStart(t),function(t,e){r.inputs[e]=t,n(0,r)},function(t,e){r.outputs[e]=t,n(0,r)},function(t){r=t,n(0,r)},function(t){i=t,n(1,i),n(4,s),n(5,o),n(0,r)}]}class yt extends K{constructor(t){super(),J(this,t,kt,xt,i,{node:0})}}class wt{constructor(t){return this._value=t,this.reactive=W(t),new Proxy(this,{get:(t,e)=>"reactive"==e?t.reactive:"dirty"==e?(this.reactive.set(t._value),()=>{}):"function"==typeof t._value[e]?t._value[e].bind(t._value):t._value[e],set:(t,e,n)=>(t._value[e]=n,this.reactive.set(t._value),!0)})}}class It{constructor(t){this.graph=t,this.horizontalDepth=.5,this.veritcalDepth=.5}initializeNode(t){t=t||0,this.graph.nodes[t].position.x=300*this.horizontalDepth,this.graph.nodes[t].position.y=100*this.veritcalDepth,this.horizontalDepth++;let e=this.graph.relations.filter(e=>e.sourceNodeIndex==t);for(let n=0;n<this.graph.nodes[t].outputs.length;n++){let s=e.filter(t=>t.sourceSocketIndex==n);0!=s.length&&(this.initializeNode(s[0].targetNodeIndex),n!=this.graph.nodes[t].outputs.length-1&&this.veritcalDepth++)}this.horizontalDepth--}}function St(t,e,n){const s=t.slice();return s[12]=e[n],s[14]=n,s}function _t(t,e,n){const s=t.slice();return s[15]=e[n],s[14]=n,s}function Nt(t){let e,n;function s(e){t[4].call(null,e,t[14])}let o={};void 0!==t[0].nodes[t[14]]&&(o.node=t[0].nodes[t[14]]);const i=new yt({props:o});return _.push(()=>G(i,"node",s)),{c(){P(i.$$.fragment)},m(t,e){U(i,t,e),n=!0},p(n,s){t=n;const o={};!e&&1&s&&(e=!0,o.node=t[0].nodes[t[14]],Y(()=>e=!1)),i.$set(o)},i(t){n||(F(i.$$.fragment,t),n=!0)},o(t){L(i.$$.fragment,t),n=!1},d(t){q(i,t)}}}function Tt(t,e){let n,s,o;function i(t){e[5].call(null,t,e[14])}let r={};void 0!==e[1][e[14]]&&(r.relation=e[1][e[14]]);const c=new ot({props:r});return _.push(()=>G(c,"relation",i)),{key:t,first:null,c(){n=g(""),P(c.$$.fragment),this.first=n},m(t,e){a(t,n,e),U(c,t,e),o=!0},p(t,n){e=t;const o={};!s&&2&n&&(s=!0,o.relation=e[1][e[14]],Y(()=>s=!1)),c.$set(o)},i(t){o||(F(c.$$.fragment,t),o=!0)},o(t){L(c.$$.fragment,t),o=!1},d(t){t&&d(n),q(c,t)}}}function Et(t){let e,n,o,i,r=[],c=new Map,l=t[0].nodes,f=[];for(let e=0;e<l.length;e+=1)f[e]=Nt(_t(t,l,e));const g=t=>L(f[t],1,1,()=>{f[t]=null});let x=t[1];const b=t=>t[12].index;for(let e=0;e<x.length;e+=1){let n=St(t,x,e),s=b(n);c.set(s,r[e]=Tt(s,n))}return{c(){e=p("div");for(let t=0;t<f.length;t+=1)f[t].c();n=$();for(let t=0;t<r.length;t+=1)r[t].c();v(e,"class","graph svelte-1t1skuu")},m(s,c){a(s,e,c);for(let t=0;t<f.length;t+=1)f[t].m(e,null);u(e,n);for(let t=0;t<r.length;t+=1)r[t].m(e,null);o=!0,i=[m(e,"touchstart",t[6]),m(e,"mousedown",t[7]),m(e,"touchmove",t[8]),m(e,"mousemove",t[9]),m(e,"touchend",t[10]),m(e,"mouseup",t[11])]},p(t,[s]){if(1&s){let o;for(l=t[0].nodes,o=0;o<l.length;o+=1){const i=_t(t,l,o);f[o]?(f[o].p(i,s),F(f[o],1)):(f[o]=Nt(i),f[o].c(),F(f[o],1),f[o].m(e,n))}for(A(),o=l.length;o<f.length;o+=1)g(o);j()}const o=t[1];A(),r=function(t,e,n,s,o,i,r,c,l,u,a,d){let h=t.length,p=i.length,f=h;const g={};for(;f--;)g[t[f].key]=f;const $=[],m=new Map,v=new Map;for(f=p;f--;){const t=d(o,i,f),c=n(t);let l=r.get(c);l?s&&l.p(t,e):(l=u(c,t),l.c()),m.set(c,$[f]=l),c in g&&v.set(c,Math.abs(f-g[c]))}const x=new Set,b=new Set;function k(t){F(t,1),t.m(c,a),r.set(t.key,t),a=t.first,p--}for(;h&&p;){const e=$[p-1],n=t[h-1],s=e.key,o=n.key;e===n?(a=e.first,h--,p--):m.has(o)?!r.has(s)||x.has(s)?k(e):b.has(o)?h--:v.get(s)>v.get(o)?(b.add(s),k(e)):(x.add(o),h--):(l(n,r),h--)}for(;h--;){const e=t[h];m.has(e.key)||l(e,r)}for(;p;)k($[p-1]);return $}(r,s,b,1,t,o,c,e,R,Tt,null,St),j()},i(t){if(!o){for(let t=0;t<l.length;t+=1)F(f[t]);for(let t=0;t<x.length;t+=1)F(r[t]);o=!0}},o(t){f=f.filter(Boolean);for(let t=0;t<f.length;t+=1)L(f[t]);for(let t=0;t<r.length;t+=1)L(r[t]);o=!1},d(t){t&&d(e),h(f,t);for(let t=0;t<r.length;t+=1)r[t].d();s(i)}}}class Dt{constructor(t){this.nodes=t.nodes.map((t,e)=>new bt(t,e)),this.relations=new wt(t.relations.map((t,e)=>new nt(t,e,this)))}dispatchToChildren(t,e){this.nodes.forEach(n=>n.dispatch(t,e)),this.relations.forEach(n=>n.dispatch(t,e))}update(){this.nodes.forEach(t=>t.update()),this.relations.forEach(t=>t.update())}removeRelation(t){let e="input"==t.type?e=>e.targetNodeIndex==t.nodeIndex&&e.targetSocketIndex==t.index:e=>e.sourceNodeIndex==t.nodeIndex&&e.sourceSocketIndex==t.index,n=this.relations.findIndex(e);n>=0&&(this.relations.splice(n,1),this.relations.dirty())}}function Xt(t,e,n){let s,{graph:o}=e,i=new Dt(o);I(()=>(t=>new It(t).initializeNode())(i)),i.nodes.forEach(t=>t.subscribe("socketDown",(t,e)=>{i.removeRelation(e)}));let r=i.relations.reactive;c(t,r,t=>n(1,s=t));return t.$set=t=>{"graph"in t&&n(3,o=t.graph)},t.$$.update=()=>{1&t.$$.dirty&&i.update()},[i,s,r,o,function(t,e){i.nodes[e]=t,n(0,i)},function(t,e){s[e]=t,r.set(s)},t=>i.dispatchToChildren("click",t),t=>i.dispatchToChildren("click",t),t=>i.dispatchToChildren("move",t),t=>i.dispatchToChildren("move",t),t=>i.dispatchToChildren("stop",t),t=>i.dispatchToChildren("stop",t)]}return new class extends K{constructor(t){super(),J(this,t,Xt,Et,i,{graph:3})}}({target:document.body,props:{graph:{nodes:[{name:"Test1",inputs:[],outputs:[{label:"Test1"},{label:"Test2"}]},{name:"Test2",inputs:[{label:"Test"}],outputs:[]},{name:"Test3",inputs:[{label:"Test"}],outputs:[{label:"Test1"},{label:"Test2"},{label:"Test3"}]},{name:"Test4",inputs:[{label:"Test"}],outputs:[]},{name:"Test5",inputs:[{label:"Test"}],outputs:[]},{name:"Test6",inputs:[{label:"Test"}],outputs:[]}],relations:[{sourceNodeIndex:0,sourceSocketIndex:0,targetNodeIndex:1,targetSocketIndex:0},{sourceNodeIndex:0,sourceSocketIndex:1,targetNodeIndex:2,targetSocketIndex:0},{sourceNodeIndex:2,sourceSocketIndex:0,targetNodeIndex:3,targetSocketIndex:0},{sourceNodeIndex:2,sourceSocketIndex:1,targetNodeIndex:4,targetSocketIndex:0},{sourceNodeIndex:2,sourceSocketIndex:2,targetNodeIndex:5,targetSocketIndex:0}]}}})}();
//# sourceMappingURL=bundle.js.map
