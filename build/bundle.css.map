{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "..\\..\\..\\GraphEditor.svelte",
    "..\\..\\..\\RelationComponent.svelte",
    "..\\..\\..\\NodeComponent.svelte",
    "..\\..\\..\\SocketComponent.svelte",
    "..\\..\\..\\Draggable.svelte",
    "..\\..\\..\\Selectable.svelte"
  ],
  "sourcesContent": [
    "<script context=\"module\">\r\n\timport { Node } from \"./NodeComponent.svelte\";\r\n\timport { Relation } from \"./RelationComponent.svelte\";\r\n\t\r\n\texport class Graph {\r\n\t\tconstructor(graph) {\r\n\t\t\tthis.nodes = graph.nodes.map(n => new Node(n));\r\n\t\t\tthis.relations = graph.relations.map(r => new Relation(r, this));\r\n\t\t}\r\n\r\n\t\tdispatch(name, props) {\r\n\t\t\tthis.nodes.forEach(n => n.dispatch(name, props))\r\n\t\t}\r\n\r\n\t\tupdate() {\r\n\t\t\tthis.nodes.forEach(n => n.update())\r\n\t\t\tthis.relations.forEach(r => r.update())\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<script>\r\n \timport { onMount } from 'svelte';\r\n\r\n\timport NodeComponent from \"./NodeComponent.svelte\";\r\n\timport RelationComponent from \"./RelationComponent.svelte\";\r\n\timport { initializeLayout } from \"./Layout.js\";\r\n\r\n\texport let graph;\r\n\r\n\tlet virtualGraph = new Graph(graph);\r\n\r\n\tonMount(() => {\r\n\t\tinitializeLayout(virtualGraph);\r\n\t});\r\n\r\n\t$: virtualGraph.update();\r\n</script>\r\n\r\n<div class=\"graph\"\r\n\ton:touchstart={e => virtualGraph.dispatch(\"click\", e)}\r\n\ton:mousedown={e => virtualGraph.dispatch(\"click\", e)}\r\n\ton:touchmove={e => virtualGraph.dispatch(\"move\", e)}\r\n\ton:mousemove={e => virtualGraph.dispatch(\"move\", e)}\r\n\ton:touchend={e => virtualGraph.dispatch(\"stop\", e)}\r\n\ton:mouseup={e => virtualGraph.dispatch(\"stop\", e)}\r\n>\r\n\t{#each virtualGraph.nodes as node, i}\r\n\t\t<NodeComponent bind:node={virtualGraph.nodes[i]} />\r\n\t{/each}\r\n\t{#each virtualGraph.relations as relation, i}\r\n\t\t<RelationComponent bind:relation={virtualGraph.relations[i]}/>\r\n\t{/each}\r\n</div>\r\n\r\n<style>\r\n\t.graph {\r\n\t\tposition: relative;\r\n\t\tbackground-color: #201f20;\r\n\t\twidth: 5000px;\r\n\t\theight: 5000px;\r\n\t}\r\n</style>",
    "<script context=\"module\">\r\n    import { writable } from 'svelte/store';\r\n\r\n    export class Relation {\r\n        constructor(relation, graph) {\r\n            this.sourceNodeIndex = relation.sourceNodeIndex;\r\n            this.sourceSocketIndex = relation.sourceSocketIndex;\r\n            this.targetNodeIndex = relation.targetNodeIndex;\r\n            this.targetSocketIndex = relation.targetSocketIndex;\r\n\r\n            this.sourceSocket = graph.nodes[relation.sourceNodeIndex].outputs[relation.sourceSocketIndex];\r\n            this.targetSocket = graph.nodes[relation.targetNodeIndex].inputs[relation.targetSocketIndex];\r\n            \r\n            this.curve = writable();\r\n        }\r\n\r\n        update() {\r\n            let targetX = this.targetSocket.x;\r\n            let sourceX = this.sourceSocket.x;\r\n            let targetY = this.targetSocket.y;\r\n            let sourceY = this.sourceSocket.y;\r\n\r\n            if(!targetX || !targetY || !sourceX || !sourceY || !this.curvature)\r\n                return;\r\n\r\n            // We're using horizontal Cubic Bezier curves\r\n            // So we need to define 2 target points and 2 control points.\r\n\r\n            // Control points are half way from target\r\n            let cx1 = targetX - (targetX - sourceX) / 2;\r\n            let cx2 = sourceX + (targetX - sourceX) / 2;\r\n\r\n            // We make sure the control points dont go beyond the target nodes\r\n            // We also add extra space to increase the curvature.\r\n            cx1 = Math.max(cx1, sourceX + this.curvature);\r\n            cx2 = Math.min(cx1, targetX - this.curvature);\r\n\r\n            // Y cordinate are inline with the nodes.\r\n            let cy1 = sourceY;\r\n            let cy2 = targetY;\r\n\r\n            this.curve.set(`M${sourceX},${sourceY} C${cx1}, ${cy1} ${cx2},${cy2} ${targetX},${targetY}`);\r\n        }\r\n    }\r\n</script>\r\n\r\n<script>\r\n    export let relation;\r\n    export let curvature = 100;\r\n\r\n    relation.curvature = curvature;\r\n\r\n    let curve;\r\n\r\n    $: {\r\n        relation.update();\r\n        curve = relation.curve;\r\n    } \r\n</script>\r\n\r\n<div class=\"node-relation\">\r\n    <svg>\r\n        <filter id=\"highlight\" filterUnits=\"userSpaceOnUse\" >\r\n            <feGaussianBlur stdDeviation=\"5\" in=\"SourceGraphic\"/>\r\n        </filter>\r\n        <g>\r\n            <path class=\"curve-selector\" d={$curve} />\r\n        </g>\r\n        <g>\r\n            <path class=\"curve\" d={$curve} />\r\n        </g>\r\n    </svg>\r\n</div>\r\n\r\n<style>\r\n    .node-relation {\r\n        position: absolute;\r\n        pointer-events: none;\r\n        top: 0;\r\n        left: 0;\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n\r\n    svg {\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n\r\n    .curve-selector {\r\n        filter: url(#highlight);\r\n        fill: none;\r\n        pointer-events: all;\r\n        stroke-opacity: 0;\r\n        stroke-linecap: round;\r\n        stroke-width: 10px;\r\n        stroke: #8ca6c0;\r\n    }\r\n\r\n    .curve-selector:hover {\r\n        \r\n        stroke-opacity: 0.5;\r\n    }\r\n    \r\n    .curve {\r\n        stroke: #8ca6c0;\r\n        stroke-width: 1;\r\n        stroke-linecap: round;\r\n        fill: none;\r\n    }\r\n</style>",
    "<script context=\"module\">\r\n    import { Socket } from './SocketComponent.svelte';\r\n\r\n    export class Node extends EventBroker {\r\n        constructor(node) {\r\n            super();\r\n            this.name = node.name;\r\n            this.inputs = node.inputs.map(s => new Socket(s));\r\n            this.outputs = node.outputs.map(s => new Socket(s));\r\n        }\r\n        update() {\r\n            this.inputs.forEach(i => i.update());\r\n            this.outputs.forEach(o => o.update());\r\n        }\r\n    }\r\n</script>\r\n\r\n<script>\r\n    import EventBroker from './EventBroker';\r\n    import Draggable from './Draggable.svelte';\r\n    import Selectable from './Selectable.svelte';\r\n    import SocketComponent from './SocketComponent.svelte';\r\n\r\n    export let node;\r\n\r\n    // The top level container needs to be shared with the Draggable\r\n    // component to allow it to be dragged.\r\n    let container;\r\n</script>\r\n\r\n<Selectable bind:events={node} bind:container={container} absolute={true} >\r\n    <Draggable\r\n        bind:events={node}\r\n        bind:x={node.x}\r\n        bind:y={node.y}\r\n        title={node.name}\r\n        container={container}\r\n        on:drag={() => node.update()}>\r\n        <div class=\"node\">\r\n            {#if node.inputs.length > 0}\r\n                <div class=\"inputs\">\r\n                    <label>Inputs</label>\r\n                    <ul class=\"sockets\">\r\n                    {#each node.inputs as { label }, i}\r\n                        <li>\r\n                            <SocketComponent bind:socket={node.inputs[i]} />\r\n                            <span>{label}</span>\r\n                        </li>\r\n                    {/each}\r\n                    </ul>\r\n                </div>\r\n            {/if}\r\n            {#if node.outputs.length > 0}\r\n                <div class=\"outputs\">\r\n                    <label>Outputs</label>\r\n                    <ul class=\"sockets\">\r\n                    {#each node.outputs as { label }, i}\r\n                        <li>\r\n                            <span>{label}</span>\r\n                            <SocketComponent bind:socket={node.outputs[i]} />\r\n                        </li>\r\n                    {/each}\r\n                    </ul>\r\n                </div>\r\n            {/if}\r\n        </div>\r\n    </Draggable>\r\n</Selectable>\r\n\r\n<style>\r\n\t.node {\r\n        width: 100%;\r\n        position: relative;\r\n        display: flex;\r\n        user-select: none;\r\n    }\r\n\r\n    .inputs, .outputs {\r\n        width: 100%;\r\n        padding: 0 3px;\r\n    }\r\n\r\n    label {\r\n        color: #dddddd;\r\n        font-size: x-small;\r\n        display: block;\r\n        text-align: center;\r\n    }\r\n\r\n    .sockets {\r\n        margin: 0;\r\n        padding: 0;\r\n        list-style: none;\r\n        width: 100%;\r\n    }\r\n    \r\n    .sockets li {\r\n        display: inline-flex;\r\n        width: 100%;\r\n        height: 20px;\r\n        line-height: 10px;\r\n        align-items: center;\r\n    }\r\n\r\n    .sockets li span {\r\n        width: 100%;\r\n        color: #c0bfbf;\r\n        font-size: x-small;\r\n        padding: 0 5px;\r\n    }\r\n\r\n    .inputs {\r\n        border-right: 0.5px solid black;\r\n    }\r\n\r\n    .outputs {\r\n        border-left: 0.5px solid black;\r\n    }\r\n\r\n    .inputs, .inputs .sockets, .inputs li {\r\n        float: left;\r\n        text-align: left;\r\n    }\r\n\r\n    .outputs, .outputs .sockets, .outputs li {\r\n        float: right;\r\n        text-align: right;\r\n    }\r\n</style>",
    "<script context=\"module\">\r\n    export class Socket  {\r\n        constructor(socket) {\r\n            this.label = socket.label;\r\n        }\r\n\r\n        update() {\r\n            if (!this.element) return;\r\n\r\n            let boundingBox = this.element.getBoundingClientRect();\r\n            this.x = boundingBox.left + boundingBox.width / 2;\r\n            this.y = boundingBox.top + boundingBox.height / 2;\r\n        }\r\n    }\r\n</script>\r\n\r\n<script>\r\n    export let socket;\r\n</script>\r\n\r\n<button bind:this={socket.element}></button>\r\n\r\n<style>\r\n    button {\r\n        outline: none;\r\n        box-sizing: content-box;\r\n        border-radius: 10px;\r\n        padding: 3px;\r\n        width: 4px;\r\n        height: 4px;\r\n        margin: 1px auto;\r\n        background-color: black;\r\n        flex-shrink: 0;\r\n        border: 0.5px solid #b3d8fc;\r\n    }\r\n\r\n    button:active {\r\n        background-clip: content-box;\r\n        background-color: #b3d8fc;\r\n    }\r\n</style>",
    "<script>\r\n    import { createEventDispatcher } from 'svelte';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n    \r\n    // Parent events need to be passed down to allow component to be dragged. \r\n    export let events;\r\n\r\n    export let title = \"\";\r\n\r\n    let self;\r\n\r\n    // The \"draggable\" container element can be passed in as a dependancy\r\n    // if this component needs a wrapper.\r\n    export let container = null;\r\n\r\n    export let x = 0;\r\n    export let y = 0;\r\n\r\n    $: if (!container) container = self;\r\n    $: if (container) container.style.transform = \"translate3d(\" + x + \"px, \" + y + \"px, 0)\";\r\n\r\n    let dragging = false;\r\n    let initialX;\r\n    let initialY;\r\n\r\n    // Initial function for initiating drag\r\n    function dragStart(e) {\r\n        \r\n        e.preventDefault();\r\n\r\n        // event can be either touchstart or mousedown\r\n        if (event.type === \"touchstart\") {\r\n            initialX = e.touches[0].clientX - x;\r\n            initialY = e.touches[0].clientY - y;\r\n        } else {\r\n            initialX = e.clientX - x;\r\n            initialY = e.clientY - y;\r\n        }\r\n\r\n        events.subscribe(\"move\", drag);\r\n        events.subscribe(\"stop\", dragEnd);\r\n\r\n        dragging = true;\r\n    }\r\n\r\n    function dragEnd(event) {\r\n        initialX = x;\r\n        initialY = y;\r\n\r\n        dragging = false;\r\n\r\n        // When the drag ends, remove the events.\r\n        events.unsubscribe(\"move\");\r\n        events.unsubscribe(\"stop\");\r\n    }\r\n\r\n    function drag(e) {\r\n        if (!dragging) return;\r\n\r\n        e.preventDefault();\r\n\r\n        if (e.type === \"touchmove\") {\r\n            x = e.touches[0].clientX - initialX;\r\n            y = e.touches[0].clientY - initialY;\r\n        } else {\r\n            x = e.clientX - initialX;\r\n            y = e.clientY - initialY;\r\n        }\r\n\r\n        // Inform any listening nodes that the component is being dragged.\r\n        dispatch('drag');\r\n    }\r\n\r\n</script>\r\n\r\n<div class=\"drag\" bind:this={self}>\r\n    <div class=\"selector\"\r\n        on:touchstart={dragStart}\r\n        on:mousedown={dragStart}>\r\n        <label>{title}</label>\r\n    </div>\r\n    <slot/>\r\n</div>\r\n\r\n<style>\r\n    .selector {\r\n        width: 100%;\r\n        height: 20px;\r\n        border-bottom: 1px solid black;\r\n    }\r\n\r\n    label {\r\n        color: #dddddd;\r\n        font-size: small;\r\n        display: block;\r\n        text-align: center;\r\n    }\r\n\r\n    .drag {\r\n        margin: 0.5px;\r\n        min-width: 100px;\r\n        min-height: 50px;\r\n        user-select: none;\r\n    }\r\n\r\n    \r\n</style>",
    "<script>\r\n    import { onMount, onDestroy } from 'svelte';\r\n\r\n    export let events;\r\n    export let absolute = false;\r\n    export let container = null;\r\n\r\n    let selected = false;\r\n    let isAbove = false;\r\n\r\n    onMount(() => events.subscribe(\"click\", (e) => {\r\n        // When clicking, the mouse needs to be above the containers to be selected.\r\n        if (isAbove) selected = true;\r\n        else selected = false;\r\n    }));\r\n    \r\n    onDestroy(() => events.unsubscribe(\"click\"));\r\n</script>\r\n\r\n<div class=\"selectable\" class:selected class:absolute\r\n    bind:this={container}\r\n    on:mouseenter={e => isAbove = true}\r\n    on:mouseleave={e => isAbove = false}>\r\n    <slot />\r\n</div>\r\n\r\n<style>\r\n\r\n    .absolute {\r\n        position: absolute;\r\n    }\r\n\r\n    .selectable {\r\n        border: 0.5px solid;\r\n        border-radius: 7px;\r\n        padding: 0.5px;\r\n        background-color: #3a393a;\r\n    }\r\n\r\n    .selectable:hover {\r\n        border-color: #adacac;\r\n        z-index: 1;\r\n    }\r\n\r\n    .selected {\r\n        border-color: #8ca6c0;\r\n        z-index: 1;\r\n    }\r\n\r\n    .selected:hover {\r\n        border-color: #96b2ce;\r\n        border-width: 1px;\r\n        padding: 0px;\r\n        margin: 0px;\r\n    }\r\n</style>"
  ],
  "names": [],
  "mappings": "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"
}